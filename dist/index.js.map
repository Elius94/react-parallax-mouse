{"version":3,"file":"index.js","sources":["../src/Child.tsx","../src/Container.tsx"],"sourcesContent":["import React from 'react';\r\nimport { SpringHelperConfig } from 'react-motion';\r\nimport { Middleware } from './interfaces';\r\n\r\ninterface Props {\r\n    factorX?: number;\r\n    factorY?: number;\r\n    springConfig?: SpringHelperConfig;\r\n    children?: JSX.Element | JSX.Element[];\r\n    className?: string;\r\n    updateStyles?: Middleware | React.CSSProperties;\r\n    inverted?: boolean;\r\n}\r\n\r\nconst MouseParallaxChild = ({ children }: Props) => (<> {children} </>);\r\n\r\nexport default MouseParallaxChild;","import React, { useCallback, useEffect, useState } from 'react';\r\nimport { Motion, spring } from 'react-motion';\r\n\r\ninterface Props {\r\n    children: JSX.Element[] | JSX.Element;\r\n    resetOnLeave?: boolean;\r\n    useWindowMouseEvents?: boolean;\r\n    inverted?: boolean;\r\n    containerStyles?: React.CSSProperties;\r\n    className?: string;\r\n    globalFactorX?: number;\r\n    globalFactorY?: number;\r\n    disableCSSTransition?: boolean;\r\n}\r\n\r\n// Helper function to check if a variable is a function\r\nconst isFunction: (value: any) => boolean = value => value && (Object.prototype.toString.call(value) === \"[object Function]\" || \"function\" === typeof value || value instanceof Function);\r\n\r\nconst MouseParallaxContainer = ({ children, resetOnLeave, useWindowMouseEvents, inverted, containerStyles, className, globalFactorX = 1, globalFactorY = 1, disableCSSTransition }: Props) => {\r\n\r\n    // Convert one-child cases into one dimensional array to map over\r\n    if (!Array.isArray(children))\r\n        children = [children];\r\n\r\n    const [offset, setOffset] = useState<[number, number]>([0, 0]);\r\n    // Container reference with callback to use it inside of useEffect\r\n    const [containerRef, setContainerRef] = useState<{ current: HTMLDivElement | null }>({ current: null });\r\n    const containerRefWithCallback = useCallback(node => { if (node !== null) { setContainerRef({ current: node }); } }, []);\r\n\r\n    const getMousePosition = useCallback((e: React.MouseEvent<HTMLDivElement, MouseEvent> | MouseEvent) => {\r\n\r\n        var rect = (containerRef.current) ? containerRef.current.getBoundingClientRect() : { left: 0, top: 0 };\r\n        return {\r\n            x: e.clientX - rect.left,\r\n            y: e.clientY - rect.top\r\n        };\r\n\r\n    }, [containerRef])\r\n\r\n    const mouseMovementHandler = useCallback((e: React.MouseEvent<HTMLDivElement, MouseEvent> | MouseEvent) => {\r\n        if (containerRef.current) {\r\n            var containerHeight = containerRef.current.clientHeight;\r\n            var containerWidth = containerRef.current.clientWidth;\r\n            var mousePosition = getMousePosition(e);\r\n            var relativeToCenter: [number, number] = [\r\n                containerWidth / 2 - mousePosition.x,\r\n                containerHeight / 2 - mousePosition.y\r\n            ];\r\n            setOffset(relativeToCenter);\r\n        }\r\n    }, [containerRef, getMousePosition, inverted]);\r\n\r\n    // Use window event handler when useWindowMouseEvents is enabled\r\n    useEffect(() => {\r\n        if (useWindowMouseEvents && containerRef.current) {\r\n            window.addEventListener('mousemove', mouseMovementHandler, false);\r\n            if (resetOnLeave)\r\n                window.addEventListener('mouseout', () => setOffset([0, 0]), false);\r\n        }\r\n        return () => {\r\n            window.removeEventListener('mousemove', mouseMovementHandler, false);\r\n            if (resetOnLeave)\r\n                window.removeEventListener('mouseout', () => setOffset([0, 0]), false);\r\n        }\r\n    }, [containerRef, mouseMovementHandler, resetOnLeave, useWindowMouseEvents]);\r\n\r\n    return (\r\n        <>\r\n            <div\r\n                className={(className) && className}\r\n                id=\"mouse-parallax-container\"\r\n                style={{ overflow: 'hidden', position: 'relative', ...containerStyles }}\r\n                ref={containerRefWithCallback}\r\n                onMouseMove={(!useWindowMouseEvents) ? mouseMovementHandler : () => { }}\r\n                onMouseLeave={(resetOnLeave && !useWindowMouseEvents) ? (() => setOffset([0, 0])) : () => { }}\r\n            >\r\n                {children.map(\r\n                    (child, index) => (\r\n                        (child) && (\r\n\r\n                            <Motion key={child.key || index} style={{\r\n\r\n                                x: spring(\r\n                                    offset[0]\r\n                                    * (child.props.factorX || 0)\r\n                                    * globalFactorX\r\n                                    * ((child.props.inverted) ? -1 : 1)\r\n                                    * ((inverted) ? -1 : 1)\r\n                                    , child.props.springConfig\r\n                                ),\r\n\r\n                                y: spring(\r\n                                    offset[1]\r\n                                    * (child.props.factorY || 0)\r\n                                    * globalFactorY\r\n                                    * ((child.props.inverted) ? -1 : 1)\r\n                                    * ((inverted) ? -1 : 1)\r\n                                    , child.props.springConfig\r\n                                )\r\n\r\n                            }}>\r\n\r\n                                {springOffset => {\r\n\r\n                                    // updateStyles Injection\r\n                                    var [transition, transform, rest] = [\"\", \"\", {}];\r\n\r\n                                    if (child.props.updateStyles) {\r\n                                        if (isFunction(child.props.updateStyles))\r\n                                            // Middleware Function\r\n                                            ({ transition=\"\", transform=\"\", ...rest } = child.props.updateStyles(\r\n                                                {\r\n                                                    \"container\": (containerRef.current) ? { x: containerRef.current.clientWidth, y: containerRef.current.clientHeight } : { x: 0, y: 0 },\r\n                                                    \"px\": springOffset,\r\n                                                    \"percentage\": (containerRef.current) ? { x: springOffset.x / containerRef.current.clientWidth * 2 * 100, y: springOffset.y / containerRef.current.clientHeight * 2 * 100 } : { x: 0, y: 0 }\r\n                                                }\r\n                                            ));\r\n                                        else\r\n                                            // Extract modified properties from styles\r\n                                            ({ transition=\"\", transform=\"\", ...rest } = child.props.updateStyles);\r\n                                    }\r\n\r\n                                    // Combine changes of the properties with additional styles from updateStyles\r\n                                    let transitionStyle = `${(!disableCSSTransition) && \"transform 1e-7s linear\"}${(transition) && \", \"}${transition}`;\r\n                                    let transformStyle = `translateX(${springOffset.x}px) translateY(${springOffset.y}px) ${transform}`;\r\n\r\n                                    // Combine all styles into one style object; Reduce unnecessary CSS styles\r\n                                    let childStyle = {\r\n                                        ...((child.props.factorX || child.props.factorY) ? {\r\n                                            willChange: \"transform\",\r\n                                            transition: transitionStyle, WebkitTransition: transitionStyle, msTransition: transitionStyle,\r\n                                            transform: transformStyle, WebkitTransform: transformStyle, msTransform: transformStyle\r\n                                        } : (child.props.updateStyles) ? {\r\n                                            transition: transition, WebkitTransition: transition, msTransition: transition,\r\n                                            transform: transform, WebkitTransform: transform, msTransform: transform,\r\n                                        } : {}),\r\n                                        ...rest\r\n                                    }\r\n\r\n                                    // Render child in container if needed\r\n                                    return (\r\n\r\n                                        ((child.props.factorX || child.props.factorY) || (child.props.className || child.props.updateStyles) && child.type.name === \"MouseParallaxChild\")\r\n                                            ?\r\n                                            <div\r\n                                                className={(child.props.className) && child.props.className}\r\n                                                style={childStyle}\r\n                                            >\r\n                                                {child}\r\n                                            </div>\r\n                                            :\r\n                                            <>\r\n                                                {child}\r\n                                            </>\r\n\r\n                                    )\r\n\r\n                                }}\r\n                            </Motion>\r\n\r\n                        )\r\n                    )\r\n                )}\r\n\r\n            </div>\r\n        </>\r\n    );\r\n\r\n}\r\n\r\nexport default MouseParallaxContainer;"],"names":["_a","children","React","resetOnLeave","useWindowMouseEvents","inverted","containerStyles","className","_b","globalFactorX","_c","globalFactorY","disableCSSTransition","Array","isArray","_d","useState","offset","setOffset","_e","current","containerRef","setContainerRef","containerRefWithCallback","useCallback","node","getMousePosition","e","rect","getBoundingClientRect","left","top","x","clientX","y","clientY","mouseMovementHandler","containerHeight","clientHeight","containerWidth","clientWidth","mousePosition","relativeToCenter","useEffect","window","addEventListener","removeEventListener","id","style","overflow","position","ref","onMouseMove","onMouseLeave","map","child","index","Motion","key","spring","props","factorX","springConfig","factorY","springOffset","value","_g","transition","transform","rest","updateStyles","Object","prototype","toString","call","Function","container","px","percentage","_f","transitionStyle","transformStyle","childStyle","willChange","WebkitTransition","msTransition","WebkitTransform","msTransform","type","name"],"mappings":";;;;;;;;;;;;;;sbAc2B,SAACA,OAAEC,aAAsB,OAACC,oDAAID,uCCI1B,SAACD,OAAEC,aAAUE,iBAAcC,yBAAsBC,aAAUC,oBAAiBC,cAAWC,kBAAAC,aAAgB,IAAGC,kBAAAC,aAAgB,IAAGC,yBAGnJC,MAAMC,QAAQb,KACfA,EAAW,CAACA,IAEV,IAAAc,EAAsBC,WAA2B,CAAC,EAAG,IAApDC,OAAQC,OAETC,EAAkCH,WAA6C,CAAEI,QAAS,OAAzFC,OAAcC,OACfC,EAA2BC,eAAY,SAAAC,GAAuB,OAATA,GAAiBH,EAAgB,CAAEF,QAASK,MAAc,IAE/GC,EAAmBF,eAAY,SAACG,GAElC,IAAIC,EAAQP,EAAoB,QAAIA,EAAaD,QAAQS,wBAA0B,CAAEC,KAAM,EAAGC,IAAK,GACnG,MAAO,CACHC,EAAGL,EAAEM,QAAUL,EAAKE,KACpBI,EAAGP,EAAEQ,QAAUP,EAAKG,OAGzB,CAACV,IAEEe,EAAuBZ,eAAY,SAACG,GACtC,GAAIN,EAAaD,QAAS,CACtB,IAAIiB,EAAkBhB,EAAaD,QAAQkB,aACvCC,EAAiBlB,EAAaD,QAAQoB,YACtCC,EAAgBf,EAAiBC,GACjCe,EAAqC,CACrCH,EAAiB,EAAIE,EAAcT,EACnCK,EAAkB,EAAII,EAAcP,GAExChB,EAAUwB,MAEf,CAACrB,EAAcK,EAAkBrB,IAgBpC,OAbAsC,aAAU,WAMN,OALIvC,GAAwBiB,EAAaD,UACrCwB,OAAOC,iBAAiB,YAAaT,GAAsB,GACvDjC,GACAyC,OAAOC,iBAAiB,YAAY,WAAM,OAAA3B,EAAU,CAAC,EAAG,OAAK,IAE9D,WACH0B,OAAOE,oBAAoB,YAAaV,GAAsB,GAC1DjC,GACAyC,OAAOE,oBAAoB,YAAY,WAAM,OAAA5B,EAAU,CAAC,EAAG,OAAK,MAEzE,CAACG,EAAce,EAAsBjC,EAAcC,IAGlDF,gDACIA,+BACIK,UAAW,GAAeA,EAC1BwC,GAAG,2BACHC,SAASC,SAAU,SAAUC,SAAU,YAAe5C,GACtD6C,IAAK5B,EACL6B,YAAehD,EAA+C,aAAvBgC,EACvCiB,aAAelD,IAAiBC,aAA+B,OAAAc,EAAU,CAAC,EAAG,KAAO,cAEnFjB,EAASqD,KACN,SAACC,EAAOC,GAAU,OACd,GAEItD,wBAACuD,UAAOC,IAAKH,EAAMG,KAAOF,EAAOR,MAAO,CAEpChB,EAAG2B,SACC1C,EAAO,IACJsC,EAAMK,MAAMC,SAAW,GACxBpD,GACE8C,EAAMK,MAAc,UAAK,EAAI,IAC9B,GAAc,EAAI,GACnBL,EAAMK,MAAME,cAGlB5B,EAAGyB,SACC1C,EAAO,IACJsC,EAAMK,MAAMG,SAAW,GACxBpD,GACE4C,EAAMK,MAAc,UAAK,EAAI,IAC9B,GAAc,EAAI,GACnBL,EAAMK,MAAME,iBAKjB,SAAAE,mBAtFWC,EAyFJC,EAAgC,CAAC,GAAI,GAAI,IAAxCC,OAAYC,OAAWC,OAExBd,EAAMK,MAAMU,gBA3FRL,EA4FWV,EAAMK,MAAMU,gBA5FsC,sBAA1CC,OAAOC,UAAUC,SAASC,KAAKT,IAAkC,mBAAsBA,GAASA,aAAiBU,WA8FjIR,YAAAnE,GAAFmB,EAA2CoC,EAAMK,MAAMU,aACpD,CACIM,UAAcvD,EAAoB,QAAI,CAAEW,EAAGX,EAAaD,QAAQoB,YAAaN,EAAGb,EAAaD,QAAQkB,cAAiB,CAAEN,EAAG,EAAGE,EAAG,GACjI2C,GAAMb,EACNc,WAAezD,EAAoB,QAAI,CAAEW,EAAGgC,EAAahC,EAAIX,EAAaD,QAAQoB,YAAc,EAAI,IAAKN,EAAG8B,EAAa9B,EAAIb,EAAaD,QAAQkB,aAAe,EAAI,KAAQ,CAAEN,EAAG,EAAGE,EAAG,kBAJlL,KAAIkC,YAAA5D,eAAU,KAAO6D,MAAlC,8BASEF,YAAAzD,GAAFqE,EAA2CxB,EAAMK,MAAMU,0BAA1C,KAAIF,YAAArD,eAAU,KAAOsD,MAAlC,8BAIT,IAAIW,EAAkB,WAAKpE,GAAyB,iCAA2B,GAAgB,aAAOuD,GAClGc,EAAiB,qBAAcjB,EAAahC,4BAAmBgC,EAAa9B,iBAAQkC,GAGpFc,SACK3B,EAAMK,MAAMC,SAAWN,EAAMK,MAAMG,QAAW,CAC/CoB,WAAY,YACZhB,WAAYa,EAAiBI,iBAAkBJ,EAAiBK,aAAcL,EAC9EZ,UAAWa,EAAgBK,gBAAiBL,EAAgBM,YAAaN,GACxE1B,EAAMK,MAAkB,aAAI,CAC7BO,WAAYA,EAAYiB,iBAAkBjB,EAAYkB,aAAclB,EACpEC,UAAWA,EAAWkB,gBAAiBlB,EAAWmB,YAAanB,GAC/D,IACDC,GAIP,OAEMd,EAAMK,MAAMC,SAAWN,EAAMK,MAAMG,UAAaR,EAAMK,MAAMrD,WAAagD,EAAMK,MAAMU,eAAqC,uBAApBf,EAAMiC,KAAKC,KAE/GvF,+BACIK,UAAYgD,EAAMK,MAAe,WAAKL,EAAMK,MAAMrD,UAClDyC,MAAOkC,GAEN3B,GAGLrD,gDACKqD"}